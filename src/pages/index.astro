---
import Layout from '../layouts/Layout.astro';
import { getAllTournaments } from '../lib/db';
import { Button } from '@/components/ui/button';
import { Alert, AlertTitle, AlertDescription } from '@/components/ui/alert';
import { Card, CardHeader, CardTitle, CardDescription, CardContent } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';

const tournaments = getAllTournaments();
const activeTournaments = tournaments.filter(t => t.status === 'registration' || t.status === 'active');
---

<Layout title="Biljardturnering - NAV">
  <div class="text-center py-12 md:py-24 bg-linear-to-br from-blue-50 to-background rounded-3xl mb-12 px-6">
    <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight lg:text-6xl mb-4">
      Velkommen til Nav sin biljardturnering! 游꿤
    </h1>
    <p class="text-xl text-muted-foreground max-w-2xl mx-auto">
      Hvert semester arrangerer vi en biljardturnering! Alle niv친er av ferdighet er hjertelig velkomne. 
      Vi legger vekt p친 at dette er et sosialt arrangement som lar deg st칮te p친 kollegaer fra alle kriker og kroker! 游뱔
    </p>
  </div>

  {activeTournaments.length > 0 ? (
    <section class="mb-16">
      <h2 class="text-3xl font-bold mb-6">Aktive turneringer</h2>
      <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
        {activeTournaments.map((tournament) => (
          <a href={`/turnering/${tournament.id}`} class="block no-underline">
            <Card class="h-full hover:bg-muted/50 transition-colors">
              <CardHeader>
                <div class="flex justify-between items-start gap-2 mb-2">
                  <CardTitle>{tournament.name}</CardTitle>
                  <Badge variant={tournament.status === 'registration' ? 'default' : 'secondary'}>
                    {tournament.status === 'registration' ? 'P친melding 친pen' : 'P친g친r'}
                  </Badge>
                </div>
                <CardDescription>
                  <p class="mb-2">{tournament.description}</p>
                  {tournament.registration_deadline && tournament.status === 'registration' && (
                    <p class="text-sm font-medium">
                      <strong>P친meldingsfrist:</strong> {new Date(tournament.registration_deadline).toLocaleDateString('nb-NO')}
                    </p>
                  )}
                </CardDescription>
              </CardHeader>
            </Card>
          </a>
        ))}
      </div>
    </section>
  ) : (
    <Alert class="mb-12">
      <AlertTitle>Ingen aktive turneringer</AlertTitle>
      <AlertDescription>
        Det er for 칮yeblikket ingen aktive turneringer. Sjekk tilbake senere eller kontakt en administrator.
      </AlertDescription>
    </Alert>
  )}

  <section class="my-16">
    <h2 class="text-3xl font-bold mb-6">Slik fungerer det</h2>
    <div class="grid gap-6 md:grid-cols-3">
      <Card>
        <CardHeader>
          <CardTitle>游닇 Meld deg p친</CardTitle>
        </CardHeader>
        <CardContent>
          Finn en aktiv turnering og registrer deg med navn og e-post. 
          P친meldingen er 친pen frem til fristen.
        </CardContent>
      </Card>
      <Card>
        <CardHeader>
          <CardTitle>游꿢 Spill kampene</CardTitle>
        </CardHeader>
        <CardContent>
          Du vil f친 tildelt motstandere gjennom turneringen. 
          Dere avtaler selv tid og sted for kampene.
        </CardContent>
      </Card>
      <Card>
        <CardHeader>
          <CardTitle>游끥 F칮lg med p친 resultater</CardTitle>
        </CardHeader>
        <CardContent>
          Resultater rapporteres av admin og du kan f칮lge med p친 stillingen underveis i turneringen.
        </CardContent>
      </Card>
    </div>
  </section>

  <section class="text-center py-12 bg-muted/30 rounded-3xl mt-12">
    <h2 class="text-3xl font-bold mb-4">Bli med i #biljard p친 Slack! 游눫</h2>
    <p class="text-lg text-muted-foreground mb-8 max-w-2xl mx-auto">
      For mer informasjon og oppdateringer om turneringene, bli med i Slack-kanalen #biljard.
    </p>
    <div class="flex justify-center gap-4">
      <a href="/turneringer">
        <Button size="lg">Se alle turneringer</Button>
      </a>
    </div>
  </section>
</Layout>
